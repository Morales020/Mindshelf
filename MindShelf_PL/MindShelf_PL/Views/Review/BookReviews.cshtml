@using MindShelf_BL.Dtos.ReviewDto
@model GetBookReviewsDto

@{
    ViewData["Title"] = $"ŸÖÿ±ÿßÿ¨ÿπÿßÿ™ {Model.BookName}";
}

<div class="container py-5">
    <div class="row">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h2 class="mb-0">üìö @Model.BookName</h2>
                </div>
                <div class="card-body">
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="d-flex align-items-center">
                                <div class="me-3">
                                    <span class="h3 text-warning">‚≠ê @Model.AverageRating</span>
                                </div>
                                <div>
                                    <p class="mb-0 text-muted">ŸÖÿ™Ÿàÿ≥ÿ∑ ÿßŸÑÿ™ŸÇŸäŸäŸÖ</p>
                                    <p class="mb-0">@Model.ReviewCount ŸÖÿ±ÿßÿ¨ÿπÿ©</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 text-end">
                            <a asp-controller="Review" asp-action="Create" asp-route-bookId="@Model.BookId" 
                               class="btn btn-success">
                                ‚úçÔ∏è ÿ£ÿ∂ŸÅ ŸÖÿ±ÿßÿ¨ÿπÿ©
                            </a>
                        </div>
                    </div>

                    @if (Model.Reviews.Any())
                    {
                        <div class="reviews-container">
                            @foreach (var review in Model.Reviews)
                            {
                                <div class="card mb-3 review-card">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-start mb-2">
                                            <div>
                                                <h6 class="card-title mb-1">üë§ @review.UserName</h6>
                                                <small class="text-muted">@review.CreatedAt.ToString("dd/MM/yyyy")</small>
                                            </div>
                                            <div class="text-warning">
                                                @for (int i = 1; i <= 5; i++)
                                                {
                                                    if (i <= review.Rating)
                                                    {
                                                        <span>‚≠ê</span>
                                                    }
                                                    else
                                                    {
                                                        <span>‚òÜ</span>
                                                    }
                                                }
                                            </div>
                                        </div>
                                        
                                        @if (!string.IsNullOrEmpty(review.Comment))
                                        {
                                            <p class="card-text">@review.Comment</p>
                                        }
                                        
                                        <div class="mt-2">
                                            <a asp-action="Details" asp-route-id="@review.ReviewId" 
                                               class="btn btn-sm btn-outline-primary">ÿπÿ±ÿ∂ ÿßŸÑÿ™ŸÅÿßÿµŸäŸÑ</a>
                                        </div>
                                    </div>
                                </div>
                            }
                        </div>
                    }
                    else
                    {
                        <div class="text-center py-5">
                            <div class="text-muted">
                                <h4>üìù ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖÿ±ÿßÿ¨ÿπÿßÿ™ ÿ®ÿπÿØ</h4>
                                <p>ŸÉŸÜ ÿ£ŸàŸÑ ŸÖŸÜ Ÿäÿ∂ŸäŸÅ ŸÖÿ±ÿßÿ¨ÿπÿ© ŸÑŸáÿ∞ÿß ÿßŸÑŸÉÿ™ÿßÿ®!</p>
                                <a asp-controller="Review" asp-action="Create" asp-route-bookId="@Model.BookId" 
                                   class="btn btn-primary">ÿ£ÿ∂ŸÅ ÿ£ŸàŸÑ ŸÖÿ±ÿßÿ¨ÿπÿ©</a>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .review-card {
        transition: transform 0.2s ease-in-out;
        border-left: 4px solid #0d6efd;
    }
    
    .review-card:hover {
        transform: translateX(5px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .reviews-container {
        max-height: 600px;
        overflow-y: auto;
    }
</style>
